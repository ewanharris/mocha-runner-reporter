Test Runner
=============
- [Description](#description)
- [Usage](#usage)
- [Structure](#structure)
- [Report Generation](#report-generation)
- [Related Tools](#related-tools)

### Description ###

test-runner is a util which lets you easily run a set of mocha tests programatically, and report the results.

something about generating helper outputs to go here

Test runs return a Promise containing the results to allow you to easily perform custom reporting alongside (or instead of) the built in reporting tool.


### Usage ###

```
> node run.js --your arguments --go --here
```

```javascript
'use strict';
const Runner = require('whatever-i-call-the-module');

const params = {...}; // See Structure

const runner = new Runner(['path/to/tests/', '/actual/test.js'], ['test/to/ignore'], params);

runner.run()
    .then(results => {
        // Optional custom reporting using the raw data...
        const report = runner.generateReport('test title', results);
        // Optional reporting using the generated report
    })
```


### Structure ###

The test runner's constructor takes

```javascript
const params = {
	title: 'Testing Test Runner',
	description: 'Tests the thing which tests the tests',
	notes: [ 'Foo bar baz',
		'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco'
	],
	args: [
		{
			aliases: ['r', 'run', 'runner'],
			description: 'does the thing',
			type: 'string'
		},
		{
			aliases: ['n', 'num', 'number'],
			description: 'doesn\'t do the thing',
			type: 'number'
		},
		{
			aliases: ['useless'],
			description: 'returns the supplied value(s), but with a typo',
			type: ['string','string[]']
		},
		{
			aliases: ['d'],
			description: 'this one has a really long description, because sometimes you need them.'
		}
	]
}
```
Which generates a helper output for the test suite

```
> node run.js -h

┌─────────────────────┐
│                     │
│ Testing Test Runner │
│                     │
└─────────────────────┘


Description:

   Tests the thing which tests the tests


Options:

   -r, --run, --runner {string}    does the thing
   -n, --num, --number {number}    doesn't do the thing
   --useless {string|string[]}     returns the supplied value(s), but with a typo
   -t, --timeout {number}          Time in milliseconds to wait before a test is counted as failing (Defaults to 300000)
   -s, --slow {number}             Time in milliseconds to wait before a test is counted as slow (Defaults to 10000)
   -R, --reporter {string}         Mocha reporter to use (Defaults to spec)


Notes:

   Foo bar baz

   Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore
   et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
```

### Report Generation ###

The runner will also let you generate a report from the data gathered during the test run. The report can be generated by using the `.generateReport()` function of the runner.

```javascript
runner.run().then(results => {
	const report = runner.generateReport('test title', results);
	console.log(report);
})
```

```
/***************\

   test title
  Test Results

\***************/

Overview:
- Test Suites Ran : 2
- Total Passes    : 6 (60%)
- Total Failures  : 4 (40%)
- Total Skipped   : 0 (0%)
- Total Duration  : 1m25s
- Start Time      : Mon Sep 19 2016 10:08:06 GMT+0100 (BST)

‖==============================
‖ Password Policy
‖==============================

- File       : /Users/example/path/authentication/password-policy.js
- Passes     : 0 (0%)
- Failures   : 1 (100%)
- Skipped    : 0 (0%)
- Duration   : 0ms

|--------------------
| Failures:
|--------------------

Failure 1:

Name     : "before all" hook: Initiate the browser instance
Duration : NaN
Error    : RuntimeError
     (UnknownError:13) An unknown server-side error occurred while processing the command.
     Problem: unknown error: cannot determine loading statusfrom disconnected: received Inspector.detached event

     Callstack:
     -> url("https://test.example.com")

=============================================

‖==============================
‖ Test signing in
‖==============================

- File       : /Users/example/path/authentication/sign-in.js
- Passes     : 6 (66.67%)
- Failures   : 3 (33.33%)
- Skipped    : 0 (0%)
- Duration   : 1m25s

|--------------------
| Failures:
|--------------------

Failure 1:

Name     : should fail to sign in with an incorrect valid user id
Duration : 832ms
Error    : expected '' to equal 'Sample Text.'
------------------------------

Failure 2:

Name     : should reset password using Forgot Password
Duration : 12s 117ms
Error    : RuntimeError
     (NoSuchWindow:23) A request to switch to a different window could not be satisfied because the window could not be found.
     Problem: no such window: target window already closed from unknown error: web view not found

     Callstack:
     -> cookie("POST",{"name":"dvid","value":"d50c333a-d3b0-472b-a195-dfe365fdddff","expiry":1537118895739})
     -> setCookie({"name":"dvid","value":"d50c333a-d3b0-472b-a195-dfe365fdddff","expiry":1537118895739})

------------------------------

Failure 3:

Name     : should change the password via My Profile
Duration : 4s 652ms
Error    : RuntimeError
     (NoSuchWindow:23) A request to switch to a different window could not be satisfied because the window could not be found.
     Problem: no such window: target window already closed from unknown error: web view not found

     Callstack:
     -> url("https://test.example.com/profile")

=============================================
```

### Related Tools ###

- [test-reporter](https://example.com) - Util for reporting the result of test runs
